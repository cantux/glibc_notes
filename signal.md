## Signals

Software interrupts. Allows processes to deal with async events.

- Could be used for IPC.
- You must own a process to be able to signal to it.
- Process can choose to handle or ignore the signal(except SIGKILL and SIGSTOP).

```
#include <unistd.h>
// Suspend a process until a signal arrives.
// Returns after handler runs.
int pause(void);

#include <signal.h>
// set up a signal handler
// Return pointer to old signal handler
void (*signal(int signo, void (*func)(int))))(int);

// sends a signal to another process or group of processes
// pid > 0, signal sent to process with PID=pid
// pid == 0, signal sent to all processes in same group
// pid < 0, signal sent to all process whose process group ID = |pid|
// pid == -1, undefined
int kill(pid_t pid, int signo);

// sends a signal to the calling process
int raise(int signo);
```

### On Program Startup
- Any signal ignored by the parent is ignored by the child.
- After fork(), all signal dispositions are identical.
- After exec() any signals being caught by the parent are set to the deault for the child.

### During System Calls
- Signals are assumed to be important
- In many Unixes, the signal will interrupt a system call to execute the handler (or default action)
- In some Unixes, the system call will restart afterwards
- In others, not may depend on how the signal was set up, and which system call is interrupted

### Signal Types
Conditions that can generate a signal: 
- terminal generated: SIGINT(CTRL-C KeyIntrrpt)
- hardware exceptions: divide by 0
- kill command, kill() fnc to kill another proc(SIGTERM)
- Software conditions: 
    - ALARM?? 
    - PIPE CONDITIONS??

* SIGSEGV: Generated by the kernel on an invalid memory reference.
* SIGPOLL: Generated when a specific event occurs on a pollable device.

* SIGHUP: Terminal hung up. Terminate

* SIGINFO
- Generated by terminal when ctrl-t is typed.
- Sent to all processes in the foreground.
- Causes process status to be displayed.

* SIGINT
- Generated by the terminal driver when CTRL-C typed.
- Sent to all foreground processes.
- Often used to terminate a rogue process.

* SIGQUIT
- Generated by the terminal driver when the quit key(CTRL-\) is typed.
- Sent to all processes in the foreground.

* SIGCONT: NOP
Sent to a stopped process when it's continued.
Default action is to continue the process/ignore, possibly redraw.

#### SIGALRM: 

Generated when a timer set by the process goes off. Default action is to terminate.

```
#include <unistd.h>
// set a timer that will expire in number of seconds at which time a SIGALRM is received.
unsigned int alarm()
```

* SIGIO??: Indicates async I/O event. Ignored.

* SIGPIPE: Generated when a process writes to a PIPE or a socket when the other end has terminated. Default action is to terminate.

#### SIGSTOP
- Job control signal to stop process.
- Cannot be ignored or caught.

#### SIGCHLD

- When a proccess terminates, parent receives a SIGCHLD
- **wait()** or **waitpid(pid)** allows a parent process to wait for a shild process to terminate.
- When a proccess terminates , the kernel maintains a small amount of info until the parent calls wait()
    - Such a child process is a zombie until the parent calls wait()
- If the parent terminates first child is inherited by init

- Parent can
    - ignore te signal (default)
    - Set up a signal handler to be called when the signal arrives
    - Use wait() for the child to finish.
        - Blocks parent
        - Returns when a child process terminates
            - Returns immediately if any child is zombie.
        - Returns child's PID

#### Read Further:
Signal Sets, sigprocmask(), sigpending(), sigaction(), sa_flags, sigsuspend(), abort

Source: https://users.soe.ucsc.edu/~sbrandt/105/Slides/Chapter10.pdf
